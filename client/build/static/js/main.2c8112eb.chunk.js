(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{116:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(10),s=a.n(o),i=(a(76),a(36)),c=a(172),l=a(44),m=a(37),u=a(8),d=a(118),p=a(161),h=a(162),f=a(89),g=a(164),b=a(119),v=a(160),y=a(158),x=a(159),w=function(e,t){for(var a in console.log("user ",e),e)window.sessionStorage.setItem(a,e[a]);window.sessionStorage.setItem("token",!0),t()},E=function(e){window.sessionStorage.clear(),e()},I=function(){return window.sessionStorage.hasOwnProperty("token")},O=function(){return{id:window.sessionStorage.getItem("_id"),name:window.sessionStorage.getItem("username"),email:window.sessionStorage.getItem("email")}},S=a(156),j="#1E90FF",k="#FA8072",C=Object(S.a)((function(e){return{blue:{color:j,fontSize:"25px",fontWeight:"600",fontFamily:"Roboto"},waitingroomHeader:{display:"flex",flexWrap:"wrap-reverse",justifyContent:"space-between",backgroundColor:"white",textAlign:"center",fontSize:"30px"},basicHeader:{display:"flex",flexWrap:"wrap-reverse",justifyContent:"space-between",textAlign:"center",marginLeft:"auto",marginRight:"auto",fontSize:"30px"},gameHeader:{display:"flex",flexWrap:"wrap-reverse",justifyContent:"space-between",textAlign:"center",marginLeft:"auto",marginRight:"auto",width:"150px"},invisible:{opacity:"0","&:hover":{cursor:"default"}},navSides:{flexGrow:"1"},navMain:{flexGrow:"1",fontFamily:"Roboto",fontWeight:"bold",backgroundColor:"white",color:"#000000","&>.MuiToolbar-root":Object(u.a)({display:"flex",justifyContent:"space-between"},e.breakpoints.down("xs"),{flexWrap:"wrap"})},red:{color:k,fontSize:"25px",fontWeight:"600",fontFamily:"Roboto"},bar:{fontSize:"25px",fontWeight:"bold"},typography:{fontSize:"25px"},myprofile:{marginLeft:e.spacing(40)}}}));function P(e){var t=Object(m.g)(),a=C(e),o=r.a.useState(!1),s=Object(i.a)(o,2),c=s[0],l=s[1],u=I()&&e.isMatchInProgres?a.typography:a.basicHeader;return r.a.createElement(y.a,{position:"sticky",className:a.navMain},r.a.createElement(x.a,null,r.a.createElement(d.a,{variant:"typography",className:u},"CLUEWORDS"),I()?r.a.createElement(n.Fragment,null,e.isMatchInProgres?r.a.createElement(n.Fragment,null,r.a.createElement(v.a,{container:!0,direction:"row",className:a.gameHeader},r.a.createElement(v.a,{item:!0,direction:"column",className:a.waitingroomHeader},r.a.createElement(v.a,{item:!0},r.a.createElement("span",{className:a.blue},e.blueScore)),r.a.createElement(v.a,{item:!0},r.a.createElement("span",{className:a.blue,style:{fontSize:"10px"}},"Blue Team"))),r.a.createElement(v.a,{item:!0,className:a.waitingroomHeader},"-"),r.a.createElement(v.a,{item:!0,direction:"column",className:a.waitingroomHeader},r.a.createElement(v.a,{item:!0},r.a.createElement("span",{className:a.red},e.redScore)),r.a.createElement(v.a,{item:!0},r.a.createElement("span",{className:a.red,style:{fontSize:"10px"}},"Red Team")))),r.a.createElement("div",null,r.a.createElement(p.a,{className:a.navSides,variant:"contained",color:"primary",onClick:function(){e.setIsMatchInProgres(!1),t.push("/welcome")}},"New game"))):null,r.a.createElement("div",null,r.a.createElement(b.a,null,r.a.createElement(h.a,{alt:"demo_picture",src:"/profile_icon.jpg"}),r.a.createElement(p.a,{onClick:function(e){l(e.currentTarget)},style:{fontFamily:"Roboto"}},"My profile"))),r.a.createElement(f.a,{id:"menu",anchorEl:c,keepMounted:!0,open:Boolean(c),onClose:function(){l(!1)}},r.a.createElement(g.a,{style:{fontFamily:"Roboto"},onClick:function(){E((function(){t.push("/"),l(!1),e.setIsMatchInProgres(!1)}))}},"Signout"))):null))}var N=a(4),M=a(91),T=a(19),R=a(20),F=a(15),A=a(21),B=a(22),G=a(165),H=a(166),L=a(169),W=function(e){return{form:{display:"flex",flexDirection:"column",maxWidth:"300px",margin:"0 auto"},formWarning:{color:"#ff0000"}}},D=Object(N.a)(W)(function(e){Object(B.a)(a,e);var t=Object(A.a)(a);function a(e){var n;return Object(T.a)(this,a),(n=t.call(this,e)).state={email:"",password:"",error:""},n.handleSubmit=n.handleSubmit.bind(Object(F.a)(n)),n.handleChange=n.handleChange.bind(Object(F.a)(n)),n}return Object(R.a)(a,[{key:"handleChange",value:function(e){this.setState(Object(u.a)({},e.target.name,e.target.value))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a={method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({email:this.state.email,password:this.state.password})};fetch("/users/login",a).then((function(e){if(200===e.status)return e.json();console.error("API error /users/login ",e)})).then((function(e){t.props.login(e.user)})).catch((function(e){console.log(e.message)}))}},{key:"render",value:function(){var e=this.props.classes,t=0!==this.state.error.length?r.a.createElement("p",{className:e.formWarning},this.state.error):null;return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{className:e.form,onSubmit:this.handleSubmit},r.a.createElement(G.a,{className:"inputBlock"},r.a.createElement(H.a,{htmlFor:"email"},"Email:"),r.a.createElement(L.a,{variant:"outlined",id:"email",name:"email",type:"email",value:this.state.email,onChange:this.handleChange,placeholder:"johndoe@gmail.com",required:!0})),r.a.createElement(G.a,{className:"inputBlock"},r.a.createElement(H.a,{htmlFor:"password"},"Password:"),r.a.createElement(L.a,{variant:"outlined",id:"password",name:"password",type:"password",value:this.state.password,onChange:this.handleChange,placeholder:"Password",required:!0})),t,r.a.createElement("div",null,r.a.createElement(p.a,{variant:"contained",color:"primary",type:"submit"},"Sign In"))))}}]),a}(n.Component)),z=a(14),_=Object(N.a)(W)(function(e){Object(B.a)(a,e);var t=Object(A.a)(a);function a(e){var n;return Object(T.a)(this,a),(n=t.call(this,e)).state={name:"",email:"",password:"",passwordConfirm:"",error:""},n.handleSubmit=n.handleSubmit.bind(Object(F.a)(n)),n.handleChange=n.handleChange.bind(Object(F.a)(n)),n.handleConfirmPassword=n.handleConfirmPassword.bind(Object(F.a)(n)),n}return Object(R.a)(a,[{key:"handleChange",value:function(e){this.setState(Object(z.a)({},this.state,Object(u.a)({},e.target.name,e.target.value)))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a="";if(this.state.password!==this.state.passwordConfirm)return a="Passwords must match",void this.setState(Object(z.a)({},this.state,{error:a}));if(this.state.password.length<6)return a="Password must be at least 6 characters long",void this.setState(Object(z.a)({},this.state,{error:a}));var n={method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({username:this.state.name,email:this.state.email,password:this.state.password})};fetch("/users",n).then((function(e){if(201===e.status)return e.json();console.log(e.message)})).then((function(e){t.props.login(e.user)})).catch((function(e){console.log(e.message)}))}},{key:"handleConfirmPassword",value:function(e){var t,a=this.state.password!==e.target.value?"Passwords must match":"";this.setState(Object(z.a)({},this.state,(t={},Object(u.a)(t,e.target.name,e.target.value),Object(u.a)(t,"error",a),t)))}},{key:"render",value:function(){var e=this.props.classes,t=0!==this.state.error.length?r.a.createElement("p",{className:e.formWarning},this.state.error):null;return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{className:e.form,onSubmit:this.handleSubmit},r.a.createElement(G.a,null,r.a.createElement(H.a,{htmlFor:"name"},"Name:"),r.a.createElement(L.a,{variant:"outlined",id:"name",name:"name",type:"text",value:this.state.name,onChange:this.handleChange,placeholder:"Enter your Name",required:!0})),r.a.createElement(G.a,null,r.a.createElement(H.a,{htmlFor:"email"},"Email:"),r.a.createElement(L.a,{variant:"outlined",name:"email",id:"email",type:"email",value:this.state.email,onChange:this.handleChange,placeholder:"Enter your Email",required:!0})),r.a.createElement(G.a,null,r.a.createElement(H.a,{htmlFor:"password"},"Password:"),r.a.createElement(L.a,{variant:"outlined",id:"password",name:"password",type:"password",minLength:"6",value:this.state.password,onChange:this.handleChange,placeholder:"Enter Password",required:!0})),r.a.createElement(G.a,null,r.a.createElement(H.a,{htmlFor:"passwordConfirm"},"Confirm Password:"),r.a.createElement(L.a,{variant:"outlined",id:"passwordConfirm",name:"passwordConfirm",type:"password",minLength:"6",value:this.state.passwordConfirm,onChange:this.handleConfirmPassword,placeholder:"Enter Password Again",required:!0})),t,r.a.createElement("div",null,r.a.createElement(p.a,{variant:"contained",color:"primary",type:"submit"},"Sign Up"))))}}]),a}(n.Component));var q=Object(N.a)((function(e){return{landingContainer:{margin:e.spacing(2)}}}))((function(e){var t=Object(n.useState)(!e.hasOwnProperty("signIn")||e.signIn),a=Object(i.a)(t,2),o=a[0],s=a[1],c=o?"Don't":"Already",l=Object(m.g)(),u=(Object(m.h)().state||{from:{pathname:"/"}}).from,p=function(e){w(e,(function(){l.replace(u)}))};return I()?r.a.createElement(m.a,{to:"/welcome"}):r.a.createElement(M.a,{className:"MuiPaper-customPrimary"},r.a.createElement(d.a,{variant:"h4"},o?"Sign In":"Sign Up"),o?r.a.createElement(D,{login:p}):r.a.createElement(_,{login:p}),r.a.createElement(d.a,{variant:"body1"},c," have an account? \xa0"),o?r.a.createElement(d.a,{variant:"h6",onClick:function(){return s(!o)}},"Sign Up"):r.a.createElement(d.a,{variant:"h6",onClick:function(){return s(!o)}},"Sign In"))})),J=a(90);function U(e){var t=e.children,a=Object(J.a)(e,["children"]);return I()?r.a.createElement(m.b,a,t):r.a.createElement(m.a,{to:{pathname:"/"}})}var Y=a(9),V=a.n(Y),$=a(17),X=a(163),K=a(87),Q=a.n(K),Z=a(85),ee=a.n(Z),te=a(86),ae=a.n(te),ne=a(84),re=a.n(ne),oe=function(e){var t=e.ping;return Object(n.useEffect)((function(){var e=setInterval(Object($.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t();case 1:case"end":return e.stop()}}),e)}))),1e3);return function(){return clearInterval(e)}}),[]),null},se=function(e){var t;return t={flexCol:{display:"flex",flexDirection:"column",alignItems:"center","&>button":{margin:"5% auto"}},availableRoles:{maxWidth:"160px",margin:"0 auto"},listItem:{justifyContent:"center",textAlign:"center"},itemText:{flex:"unset"},iconHover:{"&:hover":{cursor:"pointer",opacity:"0.8"}},verticalAlign:{alignItems:"center",display:"flex",justifyContent:"space-around"},centerText:{textAlign:"center",marginBottom:"0.5em"},leftText:{textAlign:"left"},gridContainer:{flexWrap:"wrap-reverse",justifyContent:"space-around",margin:"10px auto"},standardFlex:{display:"flex",flexWrap:"wrap"},standardFlexChild:{flexGrow:"1"},mainFill:{fill:e.palette.primary.main},rotate45:{transform:"rotate(-45deg)",margin:"1px"},outlined:{border:"1px solid ".concat(e.palette.common.gray),borderRadius:"12px","&>.MuiInputBase-root":{"&>.MuiInputBase-input":{textAlign:"center"}}},darkGray:{backgroundColor:e.palette.common.darkGray,color:e.palette.primary.contrastText},hiddenText:{opacity:"0",position:"absolute"}},Object(u.a)(t,e.breakpoints.up("md"),{borderLeft:{position:"relative","&:before":{content:"close-quote",height:"100%",width:"2px",position:"absolute",backgroundColor:e.palette.common.gray,left:"-14px",top:"60%",transform:"translateY(-50%)"}}}),Object(u.a)(t,e.breakpoints.down("xs"),{centerMobile:{textAlign:"center"}}),t},ie=function(){var e=Object($.a)(V.a.mark((function e(t){var a,n,r,o;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.url,n=t.method,r=t.body,e.prev=1,e.next=4,fetch(a,{method:n,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:"POST"===n?JSON.stringify(r):null});case 4:if(200===(o=e.sent).status){e.next=11;break}return e.next=8,o.text();case 8:return o=e.sent,console.error("failed request :: ",o),e.abrupt("return",{error:o});case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),console.log("error @ ".concat(a," raw \n"),e.t0);case 16:return e.prev=16,e.next=19,o.json();case 19:o=e.sent,e.next=25;break;case 22:e.prev=22,e.t1=e.catch(16),console.log("error @ ".concat(a," .json() \n"),e.t1);case 25:return e.abrupt("return",o);case 26:case"end":return e.stop()}}),e,null,[[1,13],[16,22]])})));return function(t){return e.apply(this,arguments)}}(),ce={RS:"Red Spy Master",RF:"Red Field Agent",BS:"Blue Spy Master",BF:"Blue Field Agent"},le=function(e){Object(B.a)(a,e);var t=Object(A.a)(a);function a(e){var n;return Object(T.a)(this,a),(n=t.call(this,e)).componentDidMount=Object($.a)(V.a.mark((function e(){var t,a,r;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=O().id,a=O().name,r=n.props.match.params.matchId,n.setState(Object(z.a)({},n.state,{matchId:r,name:a,userId:t}));case 4:case"end":return e.stop()}}),e)}))),n.copyLink=function(){n.textArea.value=n.state.matchId,n.textArea.select(),document.execCommand("copy")},n.startMatch=function(){var e=n.state,t=e.matchId,a=e.matchState,r=e.positions;n.props.history.push({pathname:"/match/".concat(t),state:{matchId:t,matchState:a,positions:r}})},n.state={userId:"",name:"",matchId:"",positions:{},matchState:{}},n.ping=n.ping.bind(Object(F.a)(n)),n.changePosition=n.changePosition.bind(Object(F.a)(n)),n}return Object(R.a)(a,[{key:"ping",value:function(){var e=Object($.a)(V.a.mark((function e(){var t,a,n,r,o,s,i,c;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,a=t.userId,n=t.matchId,r=t.positions,o=t.matchState,i=!1,e.prev=2,e.next=5,ie({url:"/matches/".concat(n,"/nextmove"),method:"POST",body:{userID:a,position:"_PING",move:"_PING"}});case 5:s=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log("error @ PING .json() \n",e.t0);case 11:for(c in console.log("res ping ",s),i=o.state!==s.state&&void 0!=s.state,ce)s.hasOwnProperty(c)?""===s[c].id||0==Object.keys(s[c]).length?r.hasOwnProperty(c)&&(delete r[c],i=!0):r.hasOwnProperty(c)?r[c].userId!==s[c].id&&(r[c]={userId:s[c].id,name:s[c].name},i=!0):(r[c]={role:ce[c],userId:s[c].id,name:s[c].name},i=!0):r.hasOwnProperty(c)&&(delete r[c],i=!0);i&&this.setState(Object(z.a)({},this.state,{positions:r,matchState:s}));case 15:case"end":return e.stop()}}),e,this,[[2,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"changePosition",value:function(){var e=Object($.a)(V.a.mark((function e(t){var a,n,r,o,s,i,c,l,m;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.state,n=a.userId,r=a.matchId,o=a.positions,s=a.name,c=t.currentTarget.dataset.id.slice(0,2),l=t.currentTarget.dataset.id.slice(2),e.prev=3,e.next=6,ie({url:"/matches/".concat(r,"/").concat(l),method:"POST",body:{userID:n,name:s,position:c}});case 6:i=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.log("error @ PING .json() \n",e.t0);case 12:for(m in i=i.info,ce)i.hasOwnProperty(m)?""===i[m].id||0==Object.keys(i[m]).length?o.hasOwnProperty(m)&&delete o[m]:o.hasOwnProperty(m)?o[m].userId!==i[m].id&&(o[m]={userId:i[m].id,name:i[m].name}):o[m]={role:ce[m],userId:i[m].id,name:i[m].name}:o.hasOwnProperty(m)&&delete o[m];this.setState(Object(z.a)({},this.state,{positions:o}));case 15:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.positions,o=t.userId,s=this.props.classes;4===Object.keys(a).length&&this.startMatch();var i=Object.keys(ce).filter((function(e){return!a.hasOwnProperty(e)})).map((function(t,a){return r.a.createElement(b.a,{key:"openRole-".concat(a),className:s.listItem},r.a.createElement(d.a,{variant:"body1"},ce[t],"\xa0\xa0"),r.a.createElement(re.a,{className:s.iconHover,"data-id":"".concat(t,"joinmatch"),onClick:e.changePosition}))})),c=Object.keys(a).map((function(t,n){return r.a.createElement(b.a,{key:"invite".concat(n),className:s.verticalAlign},r.a.createElement(ee.a,{className:s.mainFill}),r.a.createElement(d.a,{variant:"body1"},a[t].name," -\xa0",a[t].role,a[t].userId===o?" (You)":null," \xa0\xa0"),r.a.createElement(ae.a,{className:s.iconHover,"data-id":"".concat(t,"leavematch"),onClick:e.changePosition}))}));return r.a.createElement(n.Fragment,null,r.a.createElement(M.a,{className:"MuiPaper-customPrimary"},r.a.createElement(d.a,{variant:"h4"},"New Game"),document.queryCommandSupported("copy")&&r.a.createElement("textarea",{readOnly:!0,ref:function(t){return e.textArea=t},className:s.hiddenText,value:this.state.matchId}),r.a.createElement(oe,{ping:this.ping}),r.a.createElement(X.a,{className:s.availableRoles},r.a.createElement(d.a,{variant:"h5"},"Available roles"),i),r.a.createElement(v.a,{container:!0,className:s.gridContainer},r.a.createElement(v.a,{item:!0},r.a.createElement(H.a,null,"Players ready for match:"),r.a.createElement(X.a,{className:s.leftText},c)),r.a.createElement(v.a,{item:!0,className:s.borderLeft},r.a.createElement(H.a,{className:s.centerText},"Share match id:"),r.a.createElement(p.a,{variant:"outlined",onClick:this.copyLink},r.a.createElement(Q.a,{className:s.rotate45}),"Copy"))),r.a.createElement("div",null,r.a.createElement(p.a,{variant:"contained",disabled:4!==Object.keys(a).length,color:"primary",onClick:this.startMatch},"Start Match"))))}}]),a}(r.a.Component),me=Object(N.a)(se)(le),ue=a(174),de=a(121),pe=function(e){Object(B.a)(a,e);var t=Object(A.a)(a);function a(e){var n;return Object(T.a)(this,a),(n=t.call(this,e)).handleChange=function(e){n.setState(Object(z.a)({},n.state,Object(u.a)({},e.target.name,e.target.value)))},n.handleSubmit=function(e){e.preventDefault();var t=n.state.matchId;""!==t&&n.props.history.push({pathname:"/waitingroom/".concat(t)})},n.joinRandom=Object($.a)(V.a.mark((function e(){var t;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ie({url:"/matches/joinrandom",method:"GET"});case 3:t=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log("failed to create new game",e.t0);case 9:console.log(t),t.hasOwnProperty("matchID")?n.props.history.push({pathname:"/waitingroom/".concat(t.matchID)}):window.alert(t.message);case 11:case"end":return e.stop()}}),e,null,[[0,6]])}))),n.newGame=function(){var e=Object($.a)(V.a.mark((function e(t){var a,r;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ie({url:"/matches/creatematch",method:"POST",body:{hostID:O().id,isPublic:t.currentTarget.dataset.id}});case 3:r=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log("failed to create new game",e.t0);case 9:console.log("res form welcome ",r),a=r.matchID,n.props.history.push({pathname:"/waitingroom/".concat(a)});case 12:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),n.state={matchId:"",errorMess:""},n}return Object(R.a)(a,[{key:"render",value:function(){var e=this.props.classes;return r.a.createElement(n.Fragment,null,r.a.createElement(M.a,{className:"MuiPaper-customPrimary"},r.a.createElement(d.a,{variant:"h4"},"Welcome ",O().username),r.a.createElement(v.a,{container:!0,className:e.gridContainer},r.a.createElement(v.a,{item:!0},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(H.a,{className:e.centerMobile,htmlFor:"matchId"},"Join a Game:"),r.a.createElement("div",{className:e.outlined},r.a.createElement(ue.a,{name:"matchId",id:"matchId",type:"text",value:this.state.matchId,onChange:this.handleChange,placeholder:"Enter Game ID",required:!0,inputProps:{"aria-label":"naked"}}),r.a.createElement(p.a,{variant:"contained",className:e.darkGray,type:"submit"},"Join Game"))),r.a.createElement(H.a,{className:e.centerText},"Or"),r.a.createElement(p.a,{variant:"contained",className:e.darkGray,onClick:this.joinRandom},"Join Random")),r.a.createElement(v.a,{item:!0,className:e.borderLeft},r.a.createElement("form",{className:e.flexCol},r.a.createElement(H.a,{className:e.centerText},"New Game:"),r.a.createElement(p.a,{variant:"outlined","data-id":"true",onClick:this.newGame},"Public"),r.a.createElement(p.a,{variant:"outlined","data-id":"false",onClick:this.newGame},"Private"))))))}}]),a}(n.Component),he=Object(de.a)(se)(pe),fe={RS:"red",RF:"redfield",BS:"blue",BF:"bluefield"},ge=function(e){Object(B.a)(a,e);var t=Object(A.a)(a);function a(e){var n;return Object(T.a)(this,a),(n=t.call(this,e)).handleChange=function(e){n.setState(Object(u.a)({},e.target.name,e.target.value))},n.increment=function(e){n.state.num>=9||n.setState({num:parseInt(n.state.num)+1})},n.decrement=function(e){0!==n.state.num&&n.setState({num:parseInt(n.state.num)-1})},n.sendCurrentMsg=function(e){e.preventDefault();var t=n.state,a=t.num,r=t.word;""!==a&&""!==r&&(n.props.submitHint({num:a,word:r}),n.setState({num:"1",word:""}))},n.state={num:"1",word:"",chatHistory:[]},n}return Object(R.a)(a,[{key:"render",value:function(){var e=this.state,t=e.num,a=e.word,n=this.props.classes,o=this.props.chatHistory.map((function(e,t){return r.a.createElement(b.a,{className:"".concat(n.listItem," ").concat(n["listItem"+fe[e.role]]),key:"msg-".concat(t)},r.a.createElement(d.a,{variant:"subtitle2"},e.name," (",e.role,"):"),r.a.createElement(d.a,{variant:"subtitle1"},e.text))}));return r.a.createElement(M.a,{className:n.chatBox},r.a.createElement(X.a,{className:n.chatList},o),r.a.createElement("form",{onSubmit:this.sendCurrentMsg,className:n.chatForm},r.a.createElement("div",{className:n.inputStyle},r.a.createElement(ue.a,{className:n.inputBox,name:"word",value:a,onChange:this.handleChange,inputProps:{"aria-label":"naked"},placeholder:"Type here..."}),r.a.createElement("div",{className:n.inlineGrid},r.a.createElement(p.a,{disabled:this.state.num<=1,className:"".concat(n.plusMinus," MuiPaper-elevation1"),onClick:this.decrement},"-"),r.a.createElement(d.a,{className:n.numInput,variant:"h5"},t),r.a.createElement(p.a,{disabled:this.state.num>=9,className:"".concat(n.plusMinus," MuiPaper-elevation1"),onClick:this.increment},"+"))),r.a.createElement(p.a,{onClick:this.sendCurrentMsg,type:"submit",color:"primary",variant:"contained"},"Done")))}}]),a}(r.a.Component),be=Object(de.a)((function(e){return Object(u.a)({listItem:{flexDirection:"column","&> .MuiTypography-subtitle1":{padding:"5% 10%"}},listItemred:{alignItems:"flex-start","&> .MuiTypography-subtitle1":{backgroundColor:k,borderRadius:"0 10px 10px 10px",color:"#ffffff"}},listItemredfield:{alignItems:"flex-start","&> .MuiTypography-subtitle1":{backgroundColor:e.palette.common.gray,borderRadius:"0 10px 10px 10px"}},listItemblue:{alignItems:"flex-end","&> .MuiTypography-subtitle1":{backgroundColor:j,borderRadius:"10px 0 10px 10px",color:"#ffffff"}},listItembluefield:{alignItems:"flex-end","&> .MuiTypography-subtitle1":{backgroundColor:e.palette.common.gray,borderRadius:"10px 0 10px 10px"}},buttonInput:{width:"5%",height:"5%",boxShadow:"1px 1px 1px 1px black",marginRight:"1%",marginLeft:"1%"},chatList:{height:"60vh",overflowY:"scroll",overflowX:"scroll"},numberLabel:{width:20,appearance:"textfield"},chatBox:{width:"25vw",height:"100%",justifyContent:"center",alignContent:"center",flexWrap:"wrap"},chatForm:{margin:"5px auto",textAlign:"center",height:"20vh"},inputStyle:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-around",margin:"10px 5px"},inputBox:{width:"100px","&>input":{textAlign:"center"}},inlineGrid:{display:"inline-grid",gridTemplateColumns:"repeat(3, 1fr)",width:"60px"},numInput:{textAlign:"center"},plusMinus:{textAlign:"center",padding:"2px",minWidth:"unset",width:"1.75em",height:"1.75em"}},e.breakpoints.down("sm"),{chatList:{height:"55vh"}})}))(ge),ve=a(167),ye=function(e){var t=e.words,a=e.factions,n=e.classes,o=e.clickWord,s=e.spyView;return 0===t.length?null:r.a.createElement("div",{container:!0,className:n.grid},t.map((function(e,t){var i="_"===e[0],c=i?e.slice(2):e,l="chosen".concat(e.slice(1,2));return i||(l=s()?"buttonSpy"+a[t].slice(0,1):"button"),r.a.createElement(ve.a,{key:"word-".concat(t,"-").concat(i),"data-tag":t,variant:"contained",className:"".concat(n[l]," ").concat(n.gridElement," ").concat(i?n.noHover:null),onClick:o},r.a.createElement(d.a,{variant:"h5",className:n.smallWords},c))})))},xe={"Red Spy's turn":"RS","Blue Spy's turn":"BS","Red Field Operator's turn":"RF","Blue Field's turn":"BF",end:"_END"},we=a(168),Ee=a(171),Ie=function(e){Object(B.a)(a,e);var t=Object(A.a)(a);function a(){return Object(T.a)(this,a),t.apply(this,arguments)}return Object(R.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.isOver,n=t.winner,o=t.blueScore,s=t.redScore,i={blue:{color:"#1E90FF",fontSize:"20px",fontWeight:"600",fontFamily:"Roboto"},red:{color:"#FA8072",fontSize:"20px",fontWeight:"600",fontFamily:"Roboto"},sides:{flexGrow:"1"},title:{fontSize:"30px",margin:"0px",fontFamily:"Roboto",textAlign:"center",padding:"20px 16px 0px 16px"},newGame:{padding:"0 30px"},wins:{padding:"8px 0px 0px 74px",margin:"0"},score:{margin:"0px 0px 0px 0px",padding:"0px 98px"},img:{padding:"10px 0px 0px 40px"}};return r.a.createElement(Ee.a,{"aria-labelledby":"dialog-title",open:a},r.a.createElement("div",{className:i.img},r.a.createElement("img",{alt:"icon",src:"/dialog_icon.jpg",style:i.img})),r.a.createElement(we.a,{id:"dialog-title"},r.a.createElement("p",{style:i.title},"Game over!")),r.a.createElement("div",{style:i.wins},r.a.createElement("p",{style:"Blue"==n?i.blue:i.red},n," wins")),r.a.createElement("div",{style:i.score},r.a.createElement("p",null,r.a.createElement("span",{style:i.blue},o," ")," :"," ",r.a.createElement("span",{style:i.red}," ",s))),r.a.createElement(p.a,{className:i.sides,variant:"contained",color:"primary",onClick:function(){e.props.history.push("/welcome"),e.props.setIsMatchInProgres(!1)}},"New Game"))}}]),a}(n.Component),Oe=Object(m.i)(Ie),Se=function(e){Object(B.a)(a,e);var t=Object(A.a)(a);function a(e){var n,r;return Object(T.a)(this,a),(r=t.call(this,e)).componentDidMount=function(){if(null==r.props.location.state)r.props.setIsMatchInProgres(!1),r.props.history.push("/waitingroom/".concat(r.props.match.params.matchId));else{var e=r.props.location.state,t=e.matchId,a=e.matchState,n=e.positions;r.setState(Object(z.a)({},r.state,{userId:O().id,matchId:t,words:a.info.board,positionState:a.state,factions:a.info.factions,roles:Object(z.a)({},n)}))}setInterval((function(){!r.state.isOver&&r.state.secondsLeft>0&&r.setState({secondsLeft:--r.state.secondsLeft})}),1e3)},r.clickWord=function(){var e=Object($.a)(V.a.mark((function e(t){var a,n,o,s,i,c,l,m,u,d;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.state,n=a.matchId,a.positionState,o=a.words,s=a.userId,i=a.myRole,c=a.secondsLeft,l=a.turnId,m=a.factions,u=t.currentTarget.dataset.tag,r.isMyTurn()&&!r.amISpy()&&"_"!==o[u][0]){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,e.next=7,ie({url:"/matches/".concat(n,"/nextmove"),method:"POST",body:{userID:s,position:i,move:u,turnId:l}});case 7:d=e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),console.log("error @ API /matches/:matchId/nextmove");case 13:o[u]=d.info.info.board[u].slice(0,2)!==o[u].slice(0,2)?d.info.info.board[u].slice(0,2)+o[u]:o[u],void 0!=m&&(m[u]=d.info.info.factions[u].slice(0,2)),r.props.setBlueScore(d.blueScore),r.props.setRedScore(d.redScore),r.setState(Object(z.a)({},r.state,{words:o,guessesLeft:Number(d.info.numGuess),positionState:d.info.state,message:"",isOver:d.isOver,winner:d.winner,secondsLeft:l!=d.turnId?60:c,turnId:d.turnId,factions:m}));case 18:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t){return e.apply(this,arguments)}}(),r.endFieldTurn=Object($.a)(V.a.mark((function e(){var t,a,n;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.isMyTurn()&&!r.amISpy()){e.next=2;break}return e.abrupt("return");case 2:return t=r.state.myRole,e.prev=3,e.next=6,ie({url:"/matches/".concat(r.state.matchId,"/nextmove"),method:"POST",body:{userID:r.state.userId,position:t,move:xe.end,turnId:r.state.turnId}});case 6:a=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.log("error @ API /matches/:matchId/nextmove to end turn");case 12:"Have to make at least one guess for a turn"===a.message?r.setState(Object(z.a)({},r.state,{message:a.message})):(n=a.info.state,r.setState(Object(z.a)({},r.state,{positionState:n,guessesLeft:0,message:"",secondsLeft:60,turnId:a.turnId,factions:a.info.factions})));case 13:case"end":return e.stop()}}),e,null,[[3,9]])}))),r.props.setIsMatchInProgres(!0),r.props.setBlueScore(0),r.props.setRedScore(0),r.state=(n={isOver:!1,matchId:"",factions:[],myRole:"",userId:"",positionState:"",winner:"",turnId:"",secondsLeft:60,Host:"",guessesLeft:0},Object(u.a)(n,"isOver",!1),Object(u.a)(n,"winner","blue"),Object(u.a)(n,"words",[]),Object(u.a)(n,"chatHistory",[]),Object(u.a)(n,"roles",{}),Object(u.a)(n,"Host",""),n),r.submitHint=r.submitHint.bind(Object(F.a)(r)),r.ping=r.ping.bind(Object(F.a)(r)),r.isMyTurn=r.isMyTurn.bind(Object(F.a)(r)),r.amISpy=r.amISpy.bind(Object(F.a)(r)),r}return Object(R.a)(a,[{key:"isMyTurn",value:function(){return!!this.state.roles.hasOwnProperty(this.state.myRole)&&xe[this.state.positionState]===this.state.myRole}},{key:"amISpy",value:function(){return["RS","BS"].includes(this.state.myRole)}},{key:"ping",value:function(){var e=Object($.a)(V.a.mark((function e(){var t,a,n,r,o,s,i,c,l,m,u,d,p,h,f;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state,a=t.matchId,n=t.userId,r=t.positionState,o=t.words,s=t.guessesLeft,i=t.isOver,c=t.secondsLeft,l=t.turnId,m=t.roles,u=t.myRole,d=t.chatHistory,0!==o.length&&!i){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,ie({url:"/matches/".concat(a,"/nextmove"),method:"POST",body:{userID:n,position:"_PING",move:"_PING",turnId:l}});case 6:p=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.log("error @ PING .json() \n",e.t0);case 12:if(console.log("res ping ",p),p.hasOwnProperty("error"))this.props.setIsMatchInProgres(!1),this.props.history.push("/welcome");else{for(h=p.state!==r||Number(p.numGuess)!==s||d.length!==p.chatHistory.length,Object.keys(m).forEach((function(e){n===p[e].id&&(u=e),m.hasOwnProperty(e)?m[e].id!==p[e].id&&(m[e]={name:p[e].name,id:p[e].id},h=!0):m[e]={name:p[e].name,id:p[e].id}})),f=0;f<o.length;f++)o[f].slice(0,2)!==p.info.board[f].slice(0,2)&&(h=!0,o[f]=p.info.board[f].slice(0,2)+o[f]);h&&(this.props.setBlueScore(p.blueScore),this.props.setRedScore(p.redScore),this.setState(Object(z.a)({},this.state,{words:o,positionState:p.state,guessesLeft:Number(p.numGuess),message:"",roles:m,myRole:u,Host:p.Host,chatHistory:p.chatHistory,isOver:p.isOver,winner:p.winner,secondsLeft:l!=p.turnId?60:c,turnId:p.turnId,factions:p.info.factions})))}case 14:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"submitHint",value:function(){var e=Object($.a)(V.a.mark((function e(t){var a,n,r,o,s,i,c,l,m,u,d;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.state,n=a.myRole,r=a.matchId,o=a.userId,s=a.turnId,i=a.secondsLeft,c=a.positionState,l=a.guessesLeft,!this.amISpy()){e.next=10;break}if(!this.isMyTurn()){e.next=7;break}u="".concat(t.num," ").concat(t.word),d=n,e.next=8;break;case 7:return e.abrupt("return");case 8:e.next=11;break;case 10:this.amISpy()||(u=t.word,d="_CHAT");case 11:return e.prev=11,e.next=14,ie({url:"/matches/".concat(r,"/nextmove"),method:"POST",body:{userID:o,position:d,move:u,name:O().name,role:n,turnId:s}});case 14:m=e.sent,e.next=20;break;case 17:e.prev=17,e.t0=e.catch(11),console.log("error @ submitHint API");case 20:this.setState(Object(z.a)({},this.state,{positionState:m.state?m.state:c,guessesLeft:void 0!=m.numGuess?Number(m.numGuess):l,message:"",secondsLeft:m.turnId&&s!=m.turnId?60:i,turnId:m.turnId?m.turnId:s}));case 21:case"end":return e.stop()}}),e,this,[[11,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){console.log("local state",this.state);var e,t=this.props,a=t.classes,n=t.setIsMatchInProgres,o=t.blueScore,s=t.redScore,i=this.state,c=i.words,l=i.factions,m=i.positionState,u=(i.matchId,i.userId,i.guessesLeft),h=i.message,f=i.isOver,g=i.winner,b=i.chatHistory,v=(i.myRole,i.secondsLeft);return e=u>=0?u-1+" +1 guesses left":"0 guesses left",document.body.style.overflow="noscroll",r.a.createElement("div",{className:a.matchStyle},r.a.createElement(be,{submitHint:this.submitHint,chatHistory:b}),r.a.createElement("div",{className:"".concat(a.paper," ").concat(a.centerText)},r.a.createElement(d.a,{variant:"h4"},m," \xa0",this.isMyTurn()?"(You)":null),r.a.createElement(oe,{ping:this.ping}),r.a.createElement(d.a,{variant:"body1"},["RF","BF"].includes(xe[m])?e:r.a.createElement(r.a.Fragment,null,"\xa0")),""!==h?r.a.createElement("p",null,h):null,r.a.createElement("div",null,r.a.createElement(d.a,{variant:"body1"},"Time remaining: ",v)),r.a.createElement(ye,{classes:a,words:c,factions:l,clickWord:this.clickWord,spyView:this.amISpy}),this.amISpy()?null:r.a.createElement(p.a,{variant:"contained",color:"primary",onClick:this.endFieldTurn},"End Turn")),f?r.a.createElement(Oe,{isOver:f,setIsMatchInProgres:n,winner:g,blueScore:o,redScore:s}):null)}}]),a}(n.Component),je=Object(de.a)((function(e){var t;return{button:{color:"#000000",backgroundColor:"#ffffff",animationName:"$zoom",animationDuration:"0.75s",animationDirection:"forward",animationTimingFunction:"ease-in-out","&:hover":{transform:"scale(1.3)"}},buttonSpyA:{color:"#000000",backgroundColor:"#ffffff"},buttonSpyB:{color:j,backgroundColor:"#ffffff"},buttonSpyR:{color:k,backgroundColor:"#ffffff"},buttonSpyC:{color:e.palette.common.darkGray,backgroundColor:"#ffffff"},chosenB:{backgroundColor:j,color:"#ffffff"},chosenR:{backgroundColor:k,color:"#ffffff"},chosenA:{backgroundColor:"#000000",color:"#ffffff"},chosenC:{backgroundColor:e.palette.common.gray,color:e.palette.common.darkGray},noHover:{"&:hover":{cursor:"initial"}},centerText:{textAlign:"center",marginBottom:"0.5em"},leftText:{textAlign:"left"},gridContainer:{flexWrap:"wrap",justifyContent:"space-around",margin:"10px auto"},standardFlex:{display:"flex",flexWrap:"wrap"},matchStyle:{display:"flex",flexDirection:"row",maxHeight:"80vh"},flexRow:{margin:"10px",justifyContent:"space-evenly"},p:{margin:"auto",textAlign:"center"},paper:Object(u.a)({width:"80%",paddingTop:"5vh",height:"80vh",justifyContent:"center",alignItems:"center",flexDirection:"column",display:"flex"},e.breakpoints.down("sm"),{paddingTop:"2vh",height:"75vh"}),".Mui-disabled":{backgroundColor:"#B319EB"},smallWords:(t={},Object(u.a)(t,e.breakpoints.down("sm"),{fontSize:"0.8rem"}),Object(u.a)(t,e.breakpoints.down("xs"),{fontSize:"0.7rem"}),t),grid:{display:"grid",gridTemplate:"repeat(5, 1fr) / repeat(5, 1fr)",width:"90%",height:"100%",maxHeight:"55vh",margin:"0 auto"},gridElement:{display:"flex",alignItems:"center",margin:"7px",borderRadius:"7px",cursor:"pointer",wordWrap:"break-word",justifyContent:"space-evenly"}}}))(Se),ke=a(88),Ce=Object(ke.a)({typography:{fontFamily:"Roboto",fontSize:12,h4:{textAlign:"center","&:after":{content:"close-quote",borderBottom:"2px solid ".concat("#32be72"),maxWidth:"80px",display:"block",margin:"0.5em auto"}},h6:{display:"inline",cursor:"pointer"},body1:{display:"inline"}},palette:{common:{gray:"#efeeee",darkGray:"#5d5d5d"},primary:{main:"#32be72",contrastText:"#fff"},secondary:{main:"#DF1B1B"}},shape:{borderRadius:"7px"},overrides:{MuiPaper:{customPrimary:{textAlign:"center",margin:"50px auto",padding:"20px",width:"60%",maxWidth:"500px"}},MuiCard:{root:{padding:"10% 5%","&:hover":{cursor:"pointer"}}},MuiCheck:{custom:{fill:"primary"}},MuiButton:{root:{textTransform:"capitalize"},contained:{textAlign:"center",margin:"10px",padding:"10px 40px"}},MuiFormLabel:{root:{margin:"1em 0 0.5em 0",display:"block",textAlign:"left",fontWeight:"bold",color:"black",fontSize:"1em"}},MuiTextField:{root:{width:"100%",margin:"8px 0",borderRadius:"4px",boxSizing:"border-box",fontSize:"20px"}}}});var Pe=function(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],o=t[1],s=Object(n.useState)(0),u=Object(i.a)(s,2),d=u[0],p=u[1],h=Object(n.useState)(0),f=Object(i.a)(h,2),g=f[0],b=f[1];return r.a.createElement(c.a,{theme:Ce},r.a.createElement(l.a,null,r.a.createElement(P,{isMatchInProgres:a,setIsMatchInProgres:o,blueScore:d,redScore:g}),r.a.createElement(m.d,null,r.a.createElement(m.b,{exact:!0,path:"/signin",render:function(e){return r.a.createElement(q,Object.assign({},e,{signIn:!0}))}}),r.a.createElement(m.b,{exact:!0,path:"/signup",render:function(e){return r.a.createElement(q,Object.assign({},e,{signIn:!1}))}}),r.a.createElement(U,{exact:!0,path:"/welcome",component:he}),r.a.createElement(U,{exact:!0,path:"/waitingroom/:matchId",component:me}),r.a.createElement(U,{exact:!0,path:"/match/:matchId",render:function(e){return r.a.createElement(je,Object.assign({},e,{isMatchInProgres:a,setIsMatchInProgres:o,blueScore:d,setBlueScore:p,redScore:g,setRedScore:b}))}}),r.a.createElement(m.b,{path:"/",component:q}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(Pe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},76:function(e,t,a){},97:function(e,t,a){e.exports=a(116)}},[[97,1,2]]]);
//# sourceMappingURL=main.2c8112eb.chunk.js.map